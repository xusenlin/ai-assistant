import{S as u,E as p,d as I,c as r,o as f,e as T,h as e,w as s,g as a,H as y,j as m,t as S,P as d,J as b,_ as A}from"./index-9a9a0f57.js";import{d as E,u as $,a as U,b as M,c as N}from"./user-241b148a.js";import{u as V}from"./pagination-87aaff13.js";import"./request-507b28cf.js";function q(i){return{deleteRow:t=>{u.confirm("确认删除此用户吗？","确认操作",{confirmButtonText:"确认",cancelButtonText:"关闭",type:"warning"}).then(()=>{let{ID:n}=t;E({id:n}).then(()=>{p({type:"success",message:"删除成功"}),i()}).catch(()=>{})}).catch(()=>{})},setPassword:t=>{u.prompt("请输入新的密码","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel"}).then(({value:n})=>{$({id:t,password:n}).then(()=>{p({type:"success",message:"设置成功"})})}).catch(()=>{})},setStatus:t=>{const{Status:n,ID:_}=t;u.confirm(`确认${n==0?"启用":"禁用"}此用户吗？`,"确认操作",{confirmButtonText:"确认",cancelButtonText:"关闭",type:"warning"}).then(()=>{M({id:_,status:n==0?1:0}).then(()=>{p({type:"success",message:"操作成功"}),i()}).catch(()=>{})}).catch(()=>{})},setRemainingDialogueCount:t=>{u.prompt("设置用户对话次数","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel"}).then(({value:n})=>{U({id:t,count:n}).then(()=>{p({type:"success",message:"设置成功"}),i()})}).catch(()=>{})}}}const F={class:"box"},K=I({__name:"Index",setup(i){const{searchParams:h,tableData:w,paginationRef:x,setTableData:C,refreshTable:t,resetParams:n}=V(),{deleteRow:_,setPassword:k,setStatus:D,setRemainingDialogueCount:v}=q(t);return(O,j)=>{const B=r("ActionBar"),c=r("el-table-column"),l=r("el-button"),R=r("el-table"),P=r("Pagination");return f(),T("div",F,[e(B,{onReset:a(n),onRefresh:a(t)},{left:s(()=>[]),right:s(()=>[]),_:1},8,["onReset","onRefresh"]),e(R,{data:a(w),style:{width:"100%"},"max-height":"calc(100vh - 267px)"},{default:s(()=>[e(c,{prop:"ID",label:"ID"}),e(c,{prop:"Username",label:"Username"}),e(c,{prop:"IsAdmin",label:"是否是管理员"}),e(c,{prop:"TokenConsumed",label:"共消耗Token数"}),e(c,{prop:"RemainingDialogueCount",label:"剩余对话次数"}),e(c,{prop:"CreatedAt",label:"CreatedAt"}),e(c,{fixed:"right",label:"操作",width:"460"},{default:s(o=>[o.row.Username!=="Admin"?(f(),y(l,{key:0,type:o.row.Status==0?"success":"warning",onClick:d(g=>a(D)(o.row),["prevent"])},{default:s(()=>[m(S(o.row.Status==0?"启用":"禁用"),1)]),_:2},1032,["type","onClick"])):b("",!0),e(l,{type:"primary",onClick:d(g=>a(v)(o.row.ID),["prevent"])},{default:s(()=>[m(" 设置对话次数 ")]),_:2},1032,["onClick"]),o.row.Username!=="Admin"?(f(),y(l,{key:1,type:"danger",onClick:d(g=>a(_)(o.row),["prevent"])},{default:s(()=>[m(" 删除 ")]),_:2},1032,["onClick"])):b("",!0),e(l,{type:"warning",onClick:d(g=>a(k)(o.row.ID),["prevent"])},{default:s(()=>[m(" 重置密码 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(P,{ref_key:"paginationRef",ref:x,params:a(h),reqFunc:a(N),onPageData:a(C)},null,8,["params","reqFunc","onPageData"])])}}});const G=A(K,[["__scopeId","data-v-86393675"]]);export{G as default};
